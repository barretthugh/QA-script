version: '2'
services:
    qa:
        image: barretthugh/qa-jupyter
        ports:
            - "8888:8888"
        environment:
          - MONGODB=mgdb
        volumes:
            - qacode:/home
            - ../QUANTAXIS:/QUANTAXIS
            - ./:/update
        restart: always

    qacron:
        build: ./docker/qa-cron/.
        image: custom-cron
        environment:
            - MONGODB=mgdb
        volumes:
            - ./:/update
        restart: always

    qaweb:
        image: barretthugh/qa-web
        ports:
            - "8010:8010"
        environment:
            - MONGODB=mgdb
        restart: always

    mgdb:
        image: mongo:4.1.3
        ports:
            - "27017:27017"
        environment:
            - TZ=Asia/Shanghai
            - MONGO_INITDB_DATABASE=quantaxis
        volumes:
            - qamg:/data/db
        restart: always

volumes:
    qamg:
        external:
            name: qamg
    qacode:
        external:
            name: qacode
